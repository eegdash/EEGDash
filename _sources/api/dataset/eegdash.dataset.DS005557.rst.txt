..
   This documentation page is generated during the Sphinx build.
   The underlying code is manually maintained and not autogenerated.

eegdash.dataset.DS005557
========================

Free Recall with Closed-Loop Stimulation at Encoding (Encoding Classifier) (OpenNeuro ``ds005557``). Access recordings and metadata through EEGDash.

**Citation:** Haydn G. Herrema, Michael J. Kahana (2024). *Free Recall with Closed-Loop Stimulation at Encoding (Encoding Classifier)*. `10.18112/openneuro.ds005557.v1.0.0 <https://doi.org/10.18112/openneuro.ds005557.v1.0.0>`__

.. rst-class:: sd-badges

:bdg-primary:`Modality: ieeg` :bdg-info:`Tasks: 1` :bdg-secondary:`Subjects: 16` :bdg-secondary:`Recordings: 58`

.. rst-class:: sd-badges

:bdg-success:`License: CC0` :bdg-warning:`Source: openneuro` :bdg-info:`Citations: 0.0`

Dataset Information
-------------------

.. list-table::
   :widths: 25 75
   :header-rows: 0

   * - Dataset ID
     - ``DS005557``
   * - Title
     - Free Recall with Closed-Loop Stimulation at Encoding (Encoding Classifier)
   * - Year
     - 2024
   * - Authors
     - Haydn G. Herrema, Michael J. Kahana
   * - License
     - CC0
   * - Citation / DOI
     - `doi:10.18112/openneuro.ds005557.v1.0.0 <https://doi.org/10.18112/openneuro.ds005557.v1.0.0>`__
   * - Source links
     - `OpenNeuro <https://openneuro.org/datasets/ds005557>`__ | `NeMAR <https://nemar.org/dataexplorer/detail?dataset_id=ds005557>`__ | `Source URL <https://openneuro.org/datasets/ds005557>`__

.. dropdown:: Copy-paste BibTeX
   :class-container: sd-shadow-sm
   :class-title: sd-bg-light

   .. code-block:: bibtex

      @dataset{ds005557,
        title = {Free Recall with Closed-Loop Stimulation at Encoding (Encoding Classifier)},
        author = {Haydn G. Herrema and Michael J. Kahana},
        doi = {10.18112/openneuro.ds005557.v1.0.0},
        url = {https://doi.org/10.18112/openneuro.ds005557.v1.0.0},
      }

.. admonition:: Found an issue with this dataset?
   :class: tip

   If you encounter any problems with this dataset (missing files, incorrect metadata,
   loading errors, etc.), please let us know!

   .. button-link:: https://github.com/eegdash/EEGDash/issues/new?title=%5BDataset%5D%20Issue%20with%20DS005557&body=%23%23%20Dataset%0A%0A-%20%2A%2ADataset%20ID%3A%2A%2A%20DS005557%0A-%20%2A%2ATitle%3A%2A%2A%20Free%20Recall%20with%20Closed-Loop%20Stimulation%20at%20Encoding%20%28Encoding%20Classifier%29%0A%0A%23%23%20Issue%20Description%0A%0APlease%20describe%20the%20issue%20you%20encountered%20with%20this%20dataset%3A%0A%0A%23%23%20Steps%20to%20Reproduce%0A%0A1.%20%0A2.%20%0A3.%20%0A%0A%23%23%20Expected%20Behavior%0A%0A%0A%23%23%20Additional%20Context%0A%0A&labels=dataset
      :color: primary
      :outline:

      Report an Issue on GitHub

Description
-----------


**Free Recall with Closed-Loop Stimulation at Encoding (Encoding Classifier)**


**Description**

This dataset contains behavioral events and intracranial electrophysiology recordings from a delayed free recall task with closed-loop stimulation at encoding, using a classifier trained on encoding data.  The experiment consists of participants studying a list of words, presented visually one at a time, completing simple arithmetic problems that function as a distractor, and then freely recalling the words from the just-presented list in any order.  The data was collected at clinical sites across the country as part of a collaboration with the Computational Memory Lab at the University of Pennsylvania.  This dataset is a closed-loop stimulation version of the `FR1 <https://openneuro.org/datasets/ds004789>`__ and `FR2 <https://openneuro.org/datasets/ds005489>`__ datasets.
This study contains closed-loop electrical stimulation of the brain during encoding.  There is no stimulation during the distractor or retrieval phases.  Stimulation is delivered to a single electrode at a time, and the stimulation parameters are included in the bevavioral events tsv files, denoting the anode/cathode labels, amplitude, pulse frequency, pulse width, and pulse count.

**Classifier Details**

The L2 logistic regression classifier is trained to predict whether an encoded item will be subsequently recalled based on the neural features during encoding, using data from a participant's `FR1 <https://openneuro.org/datasets/ds004789>`__ sessions.  The bipolar recordings during the 0-1366 ms interval after word presentation are filtered with a Butterworth band stop filter (58-62 Hz, 4th order) to remove 60 Hz line noise, and then a Morlet wavelet transformation (wavenumber = 5) is applied to the signal to estimate spectral power, using 8 log-spaced wavelets between 3-180 Hz (center frequencies 3.0, 5.4, 9.7, 17.4, 31.1, 55.9, 100.3, 180 Hz) and 1365 ms mirrored buffers.  The powers are log-transformed prior to removal of the buffer, and then z-transformed based on the within-session mean and standard deviation across all encoding events.  These z-transformed log power values represent the feature matrix, and the label vector is the recalled status of the encoded items.  The penalty parameter is chosen based on the value that leads to the highest average AUC for all prior participants with at least two `FR1 <https://openneuro.org/datasets/ds004789>`__ sessiona, and is inversely weighted according to the class (i.e., recalled v. not recalled) imbalance to ensure the best fit values of the penalty parameter are comparable across different class distributions (recall rates).  Class weights are computed as: (1/Na) / ((1/Na + 1/Nb) / 2) where Na and Nb are the number of events in each class.
After at least 3 training sessions with a minimum of 15 lists, each participant's classifier is tested using leave-one-session-out (LOSO) cross validation, and the true AUC is compared to a 200-sample AUC distribution generated from classification of label-permuted data.  p < 0.05 (one-sided) is used as the significance threshold for continuing to the closed-loop task.

**Closed-Loop Procedure**

Each session contains 26 lists (the first being a practice list) and there is no stimulation on the first 4 lists.  The classifier ouput for each presented item on the first 4 lists is compared to the classifier output when tested on data from all previous sessions using a two-sample Kolmogorov-Smirnov test.  The null hypothesis that the current session and the training data come from the same distribution must not be rejected (p > 0.05) for the closed-loop task to continue.
The remaining 22 lists are equally divided into stimulation and no stimulation lists, with conditions balanced in each half of the session.  On stimulation lists, classifier output is evaluated during the 0-1366 ms interval following word presentation onset.  The input values are normalized using the mean and standard deviation across encoding events on all prior no stimulation lists in the session.  If the classifier output is below the median classifier output from the training sessions, stimulation occurs immediately following the 1366 ms decoding interval and lasts for 500 ms.  With a 750-1000 ms inter-stimulus interval, there is enough time for stimulation artifacts to subside before the next word onset (next classifier decoding).

**To Note**

* The iEEG recordings are labeled either "monopolar" or "bipolar."  The monopolar recordings are referenced (typically a mastoid reference), but should always be re-referenced before analysis.  The bipolar recordings are referenced according to a paired scheme indicated by the accompanying bipolar channels tables.
* Each subject has a unique montage of electrode locations.  MNI and Talairach coordinates are provided when available.
* Recordings done with the Blackrock system are in units of 250 nV, while recordings done with the Medtronic system are estimated through testing to have units of 0.1 uV.  We have completed the scaling to provide values in V.

**Contact**

For questions or inquiries, please contact sas-kahana-sysadmin@sas.upenn.edu.

Highlights
----------

.. grid:: 1 2 3 3
   :gutter: 2

   .. grid-item-card:: Subjects & recordings
      :class-card: sd-border-1

      - Subjects: 16
      - Recordings: 58
      - Tasks: 1

   .. grid-item-card:: Channels & sampling rate
      :class-card: sd-border-1

      - Channels: 110 (14), 112 (12), 76 (10), 108 (8), 109 (8), 126 (8), 127 (6), 128 (4), 83 (4), 120 (4), 64 (4), 60 (4), 97 (4), 67 (4), 70 (4), 62 (4), 121 (2), 118 (2), 136 (2), 124 (2), 125 (2), 99 (2), 95 (2)
      - Sampling rate (Hz): 1000.0
      - Duration (hours): 0.0

   .. grid-item-card:: Tags
      :class-card: sd-border-1

      - Pathology: Other
      - Modality: Visual
      - Type: Memory

   .. grid-item-card:: Files & format
      :class-card: sd-border-1

      - Size on disk: 34.7 GB
      - File count: 58
      - Format: BIDS

   .. grid-item-card:: License & citation
      :class-card: sd-border-1

      - License: CC0
      - DOI: doi:10.18112/openneuro.ds005557.v1.0.0

   .. grid-item-card:: Provenance
      :class-card: sd-border-1

      - Source: openneuro
      - OpenNeuro: `ds005557 <https://openneuro.org/datasets/ds005557>`__
      - NeMAR: `ds005557 <https://nemar.org/dataexplorer/detail?dataset_id=ds005557>`__

Quickstart
----------

**Install**

.. code-block:: bash

    pip install eegdash

**Access the data**

.. code-block:: python

    from eegdash.dataset import DS005557

    dataset = DS005557(cache_dir="./data")
    # Get the raw object of the first recording
    raw = dataset.datasets[0].raw
    print(raw.info)

**Filter/query**

.. tab-set::

   .. tab-item:: Basic

      .. code-block:: python

         dataset = DS005557(cache_dir="./data", subject="01")

   .. tab-item:: Advanced

      .. code-block:: python

         dataset = DS005557(
             cache_dir="./data",
             query={"subject": {"$in": ["01", "02"]}},
         )


Quality & caveats
-----------------

- No dataset-specific caveats are listed in the available metadata.

API
---

.. currentmodule:: eegdash.dataset

.. autoclass:: eegdash.dataset.DS005557
   :members: __init__, save
   :show-inheritance:
   :member-order: bysource


See Also
--------

* :class:`eegdash.dataset.EEGDashDataset`
* :mod:`eegdash.dataset`
* `OpenNeuro dataset page <https://openneuro.org/datasets/ds005557>`__
* `NeMAR dataset page <https://nemar.org/dataexplorer/detail?dataset_id=ds005557>`__

